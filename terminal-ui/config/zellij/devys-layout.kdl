layout {
    default_tab_template {
        pane size=1 borderless=true {
            plugin location="zellij:tab-bar"
        }
        children
        pane size=2 borderless=true {
            plugin location="file:~/.config/zellij/plugins/ai-command.wasm"
        }
    }
    
    tab name="devys" focus=true {
        pane split_direction="vertical" {
            // Left: File browser with Yazi
            pane size="20%" name="file-browser" {
                command "yazi"
                args "."
            }
            
            // Center: Editor with Helix
            pane size="60%" focus=true name="editor" {
                command "helix"
                args "."
            }
            
            // Right: AI Context & Status
            pane size="20%" split_direction="horizontal" {
                // Top: Context viewer
                pane size="70%" name="context-viewer" {
                    command "devys-context"
                    args "--mode" "watch" "--refresh-interval" "2"
                }
                
                // Bottom: Grunt status
                pane size="30%" name="grunt-status" {
                    plugin location="file:~/.config/zellij/plugins/grunt-status.wasm"
                }
            }
        }
    }
    
    tab name="terminal" {
        pane name="terminal" {
            command "zsh"
        }
    }
    
    tab name="ai-chat" {
        pane name="ai-chat" {
            command "devys-chat"
            args "--mode" "interactive" "--model" "claude-3-5-sonnet"
        }
    }
    
    tab name="logs" {
        pane split_direction="horizontal" {
            pane size="50%" name="control-plane-logs" {
                command "tail"
                args "-f" "/tmp/devys-control-plane.log"
            }
            pane size="50%" name="lsp-logs" {
                command "tail"
                args "-f" "/tmp/devys-lsp.log"
            }
        }
    }
}

keybinds {
    normal {
        // Devys-specific bindings
        bind "Alt a" { SwitchToMode "Pane"; }
        bind "Alt c" { FocusPane "context-viewer"; }
        bind "Alt g" { FocusPane "grunt-status"; }
        bind "Alt e" { FocusPane "editor"; }
        bind "Alt f" { FocusPane "file-browser"; }
        bind "Alt t" { FocusPane "terminal"; }
        
        // AI commands
        bind "Ctrl p" { LaunchPlugin "ai-command" { command "plan"; }; }
        bind "Ctrl e" { LaunchPlugin "ai-command" { command "edit"; }; }
        bind "Ctrl r" { LaunchPlugin "ai-command" { command "review"; }; }
        bind "Ctrl g" { LaunchPlugin "ai-command" { command "grunt"; }; }
        
        // Context management
        bind "Ctrl c" { LaunchPlugin "context-viz"; }
        bind "Ctrl o" { LaunchPlugin "context-viz" { command "optimize"; }; }
    }
    
    pane {
        bind "Alt a" { SwitchToMode "Normal"; }
    }
}